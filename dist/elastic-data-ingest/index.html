<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/png" href="/thumbnails/favicon.png"><meta name="generator" content="Astro v4.16.19"><title>Seven ways to ingest data into Elasticsearch! - Aravind Putrevu</title><meta name="description" content="Seven ways to ingest data into Elasticsearch!"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Social Media --><meta property="og:title" content="Seven ways to ingest data into Elasticsearch! - Aravind Putrevu"><meta property="og:description" content="Seven ways to ingest data into Elasticsearch!"><meta property="og:type" content="website"><!-- Twitter Card --><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@aravindputrevu"><meta name="twitter:title" content="Seven ways to ingest data into Elasticsearch! - Aravind Putrevu"><meta name="twitter:description" content="Seven ways to ingest data into Elasticsearch!"><link rel="stylesheet" href="/_astro/_slug_.D1oAbOhf.css">
<style>.article-header[data-astro-cid-fzx4jmue]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #eee}.article-header[data-astro-cid-fzx4jmue] h1[data-astro-cid-fzx4jmue]{margin-bottom:.5rem}.article-header[data-astro-cid-fzx4jmue] time[data-astro-cid-fzx4jmue]{color:#666;font-size:.9rem}.tags[data-astro-cid-fzx4jmue]{display:flex;gap:.5rem;margin-top:1rem;flex-wrap:wrap}.tag[data-astro-cid-fzx4jmue]{background:#f0f0f0;padding:.25rem .75rem;border-radius:3px;font-size:.85rem}.post-content[data-astro-cid-fzx4jmue]{line-height:1.8}
</style><script type="module">const d=localStorage.getItem("theme");d==="dark"&&document.documentElement.classList.add("dark");const e=document.getElementById("dark-mode-button"),o=localStorage.getItem("theme");o==="dark"&&(document.documentElement.classList.add("dark"),e&&(e.textContent="‚òÄÔ∏è"));e?.addEventListener("click",()=>{if(document.documentElement.classList.contains("dark"))document.documentElement.classList.remove("dark"),localStorage.removeItem("theme"),document.querySelector("#dark-mode")?.remove(),e.textContent="üåô";else{document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark"),e.textContent="‚òÄÔ∏è";const n=document.getElementsByTagName("head")[0],t=document.createElement("link");t.rel="stylesheet",t.id="dark-mode",t.href="/dark.css",n.appendChild(t)}});
</script></head> <body> <nav class="navbar"> <div class="container"> <div class="flex"> <div> <a href="/" class="brand"> <span class="emoji"> <img src="/images/code-flat.png" alt="code"> </span> 
Aravind Putrevu
</a> </div> <div class="flex"> <a href="/blog">Blogs</a> <a href="/archive">Archive</a> <a href="/about">About</a> <button id="dark-mode-button">üåô</button> </div> </div> </div> </nav>  <main>  <article class="container" data-astro-cid-fzx4jmue> <header class="article-header" data-astro-cid-fzx4jmue> <h1 data-astro-cid-fzx4jmue>Seven ways to ingest data into Elasticsearch!</h1> <time data-astro-cid-fzx4jmue>July 23, 2021</time> <div class="tags" data-astro-cid-fzx4jmue> <span class="tag" data-astro-cid-fzx4jmue>elasticsearch</span><span class="tag" data-astro-cid-fzx4jmue>observability</span><span class="tag" data-astro-cid-fzx4jmue>data-ingestion</span><span class="tag" data-astro-cid-fzx4jmue>cloud</span><span class="tag" data-astro-cid-fzx4jmue>tech</span> </div> </header> <div class="post-content" data-astro-cid-fzx4jmue> <p>Often people ask me how to get a specific type of data into Elasticsearch. As the number of use cases and popularity grew, there are also many ways to ingest the data. There are <a href="https://elastic.co/integrations">integrations</a> that are designed to sanitize &#x26; ingest the data by making it ready for analysis, or the data can be consumed directly via the APIs.</p>
<p>In this blog, I will explain <em>seven</em> ways to ingest data into Elasticsearch in 2021.</p>
<h2 id="elasticsearch-api">Elasticsearch API</h2>
<p>Elasticsearch offers to <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html">Create</a>, <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html">Read</a>, <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete.html">Delete</a> and <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html">Bulk</a> ingest <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html">REST APIs</a> to ingest data via a JSON body. Due to the API-oriented nature of Elasticsearch, today, we see a lot of systems that co-exist, integrate with it.</p>
<p>However, unless there is a specific need or use case, I don‚Äôt think one should use Elasticsearch API directly and leverage other ways listed below.</p>
<h2 id="api-clients">API Clients</h2>
<p>Elasticsearch API is implemented in different programming languages. These are <a href="https://www.elastic.co/guide/en/elasticsearch/client/index.html">Elasticsearch Clients</a>. Suppose you want to build a NodeJS app with search functionality using Elasticsearch, you can use the <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/installation.html">Javascript client</a>, which can communicate directly with Elasticsearch API. So, you write code using your favorite programming language. In fact, Kibana uses the same <a href="https://github.com/elastic/elasticsearch-js">elasticsearch.js</a> client library to talk to Elasticsearch.</p>
<p>Here are some code samples from various language clients on how they connect with Elasticsearch.</p>
<h3 id="javascript">JavaScript</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#81A1C1">const</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> Client</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> =</span><span style="color:#88C0D0"> require</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">'</span><span style="color:#A3BE8C">@elastic/elasticsearch</span><span style="color:#ECEFF4">'</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"><span style="color:#81A1C1">const</span><span style="color:#D8DEE9"> client</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> new</span><span style="color:#88C0D0"> Client</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span></span>
<span class="line"><span style="color:#88C0D0">  node</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> '</span><span style="color:#A3BE8C">https://localhost:9200</span><span style="color:#ECEFF4">'</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#88C0D0">  auth</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">    apiKey</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">      id</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> '</span><span style="color:#A3BE8C">foo</span><span style="color:#ECEFF4">'</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#88C0D0">      api_key</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> '</span><span style="color:#A3BE8C">bar</span><span style="color:#ECEFF4">'</span></span>
<span class="line"><span style="color:#ECEFF4">    }</span></span>
<span class="line"><span style="color:#ECEFF4">  }</span></span>
<span class="line"><span style="color:#ECEFF4">}</span><span style="color:#D8DEE9FF">)</span></span>
<span class="line"></span></code></pre>
<h3 id="java">Java</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#8FBCBB">RestHighLevelClient</span><span style="color:#D8DEE9"> client</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> new</span><span style="color:#88C0D0"> RestHighLevelClient</span><span style="color:#ECEFF4">(</span></span>
<span class="line"><span style="color:#D8DEE9">        RestClient</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">builder</span><span style="color:#ECEFF4">(</span></span>
<span class="line"><span style="color:#81A1C1">                new</span><span style="color:#88C0D0"> HttpHost</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">localhost</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 9200</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">http</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">),</span></span>
<span class="line"><span style="color:#81A1C1">                new</span><span style="color:#88C0D0"> HttpHost</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">localhost</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 9201</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">http</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">)))</span><span style="color:#81A1C1">;</span></span>
<span class="line"></span></code></pre>
<blockquote>
<p><strong>Note:</strong> There is an upcoming Elasticsearch Client that is going to replace the current REST Client. Do follow more updates in <a href="https://github.com/elastic/elasticsearch-java">this github repository</a></p>
</blockquote>
<h3 id="python">Python</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#81A1C1">from</span><span style="color:#D8DEE9FF"> elasticsearch </span><span style="color:#81A1C1">import</span><span style="color:#D8DEE9FF"> Elasticsearch</span></span>
<span class="line"><span style="color:#D8DEE9FF">es_client </span><span style="color:#81A1C1">=</span><span style="color:#88C0D0"> Elasticsearch</span><span style="color:#ECEFF4">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF">sample </span><span style="color:#81A1C1">=</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#ECEFF4">    '</span><span style="color:#A3BE8C">firstName</span><span style="color:#ECEFF4">'</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> '</span><span style="color:#A3BE8C">First Name</span><span style="color:#ECEFF4">'</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#ECEFF4">		'</span><span style="color:#A3BE8C">lastName</span><span style="color:#ECEFF4">'</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> '</span><span style="color:#A3BE8C">Last Name</span><span style="color:#ECEFF4">'</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"><span style="color:#D8DEE9FF">response </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> es_client</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">index</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">index</span><span style="color:#81A1C1">=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">data-ingest</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> id</span><span style="color:#81A1C1">=</span><span style="color:#B48EAD">1</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> body</span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF">sample</span><span style="color:#ECEFF4">)</span></span>
<span class="line"></span></code></pre>
<h2 id="beats">Beats</h2>
<p><a href="https://elastic.co/beats">Beats</a> are the data shippers of Elasticsearch primarily used for DevOps use cases. Essentially there are seven (7) beats, each for a specific data source type like <a href="https://www.elastic.co/beats/filebeat">Filebeat</a> for logs, <a href="https://www.elastic.co/beats/auditbeat">Auditbeat</a> for audit data, <a href="https://www.elastic.co/beats/metricbeat">Metricbeat</a> for metrics, and so on.</p>
<p><img src="/images/post-images/elastic-data-ingest/1-seven-beats.png" alt="More details can be found at elastic.co/beats"></p>
<p>There is an added advantage to using beats as they set up the much-needed indices, Index Lifecycle policies, adds meta data. Each of these beats offers different supported data ingestion input types.</p>
<blockquote>
<p><strong>Tip:</strong> I‚Äôve written a blog about <a href="https://aravind.dev/elastic-ilm-test/">ILM</a>, do read if you are new and want to get started with ILM.</p>
</blockquote>
<p>Use beats if there is no beats module for the data source that you want to ship. For example, it could happen mostly for logs. Say you have application-specific logging, which might be custom to your organization. Then, you could use Filebeat to ship that logs.</p>
<p>Now, what are beats modules? Over to the next section üôÇ</p>
<h2 id="beats-modules">Beats modules</h2>
<p>Beats modules are a blessing in disguise. They help you sanitize and ship the data directly to Elasticsearch, creating relevant visualization assets in Kibana such as Dashboards. There are as many as 70+ beats modules that can send data from general-purpose software like <a href="https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-kubernetes.html">Kubernetes</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-apache.html">Apache</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-mysql.html">MySQL</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-redis.html">Redis</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-mongodb.html">MongoDB</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-aws.html">AWS</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-gcp.html">GCP</a>, <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-azure.html">Azure</a> and so on.</p>
<p><img src="/images/post-images/elastic-data-ingest/2-modules.png" alt="AWS Module showing CloudTrail Stats"></p>
<h2 id="logstash-and-its-plugins">Logstash and its plugins</h2>
<p>Initial days of Elasticsearch, Logstash is the only way to ship time-series data or from other systems. <a href="https://www.elastic.co/logstash/">Logstash</a> also plays a vital role as an ETL engine, pulling data from so many sources, transforming/filtering them, and sending them to Elasticsearch.</p>
<p>More than <a href="https://www.elastic.co/guide/en/logstash/current/input-plugins.html">350 plugins</a> in the Logstash ecosystem can pull data from a wide variety of data sources.</p>
<p>For example, you can pull data from an <a href="https://www.elastic.co/guide/en/logstash/current/plugins-inputs-s3.html">S3 bucket</a>, <a href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-mutate.html">transform</a> it, push it to <a href="https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html">Elasticsearch</a>. Similarly to that, syncing data from an <a href="https://www.elastic.co/guide/en/logstash/current/plugins-inputs-jdbc.html">RDBMS</a>.</p>
<p>However, I‚Äôd recommend you ship data using beats and use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/ingest.html">ingest pipelines</a> in Elasticsearch to run a simple transformation on the ingested documents. And, only use Logstash if you can‚Äôt find a beats module or will not be able to install an agent like Filebeat!</p>
<h2 id="other-oss-connectors">Other OSS connectors</h2>
<p><img src="/images/post-images/elastic-data-ingest/3-oss-connectors.png" alt="Fluentd - an OSS data collector &#x26; Apache Kafka - an OSS message queue system"></p>
<p>As discussed initially, the API-oriented nature of Elasticsearch built a vast open source or third-party connector base.</p>
<blockquote>
<p><strong>Note:</strong>¬†¬†OSS Connectors are not maintained or managed by Elastic. They might not be using all the best practices (calling APIs), shipping data in a suitable format (ECS) that tools like Kibana could leverage.</p>
</blockquote>
<p><strong>FluentD</strong> - an OSS data collector for a unified logging layer using which you could ship logs to Elasticsearch.</p>
<p><strong>Kafka</strong> - an event streaming platform, quite useful if you are looking to ingest event data from various sources. Kafka has an Elasticsearch Sink connector as well as a connector to push data to Elastic Cloud.</p>
<p><strong>OpenTelemetry</strong> - Elastic has built integrations to consume data from other data systems or frameworks. One such recent integration is OpenTelemetry, an observability framework through which you can ship logs, metrics and traces.</p>
<p><strong>Framework connectors</strong> - some frameworks might be using the language clients and building a native experience for developers building on Elasticsearch. For example, Spring Data Elasticsearch is one such project where it uses Elasticsearch java client but provides additional methods to query Elasticsearch.</p>
<h2 id="elastic-agent">Elastic Agent</h2>
<p>Last but not least, an Elastic Agent is a unified agent that can collect different data sources from other systems in the form of integrations. It also provides endpoint protection to the host system!</p>
<p>You can also manage the machines using the Fleet manager. Elastic Agent is in beta right now. It could replace multiple beats installed on your host. Do give it a try by downloading it from <a href="https://www.elastic.co/downloads/elastic-agent">here</a> and don‚Äôt forget to share the feedback :)</p>
<p><img src="/images/post-images/elastic-data-ingest/4-integrations.png" alt="Elastic agent integrations"></p>
<p>You can contribute an integration to the Elastic Agent by following the guidelines mentioned in <a href="https://github.com/elastic/integrations/blob/master/CONTRIBUTING.md">this repository</a>.</p>
<h2 id="still-having-doubts-about-choosing-the-way">Still having doubts about choosing the way?</h2>
<ul>
<li>If you are building a search feature for an Application in any language, use the API Clients.</li>
<li>If you want to ship time-series data like logs, metrics ‚Äî you should take a look at Beats modules first, then beats, Logstash plugins, finally, other OSS Connectors. For collecting application traces, start with native <a href="https://www.elastic.co/guide/en/apm/agent/index.html">Elastic APM libraries</a>.</li>
</ul>
<p>If you have more questions, please comment below.</p> </div> </article>  </main> <footer class="footer flex"> <section class="container"> <nav class="footer-links"> <a href="/blog">Blogs</a> <a href="/archive">Archive</a> <a href="https://putrevu.substack.com/subscribe" target="_blank" rel="noopener noreferrer">
Newsletter
</a> <a href="https://twitter.com/aravindputrevu" target="_blank" rel="noopener noreferrer">
Twitter
</a> <a href="/rss.xml">RSS</a> </nav> <nav class="flex justify-center"> <a href="https://astro.build/" title="Built with Astro" target="_blank" rel="noopener noreferrer" class="img"> <img src="/thumbnails/astro.png" class="footer-img" alt="Astro"> </a> <a href="https://github.com/aravindputrevu" title="Open-source on GitHub" target="_blank" rel="noopener noreferrer" class="img"> <img src="/thumbnails/github.png" class="footer-img" alt="GitHub"> </a> <a href="https://github.com/taniarascia/taniarascia.com" title="Original Theme Source" target="_blank" rel="noopener noreferrer" class="img"> <img src="/thumbnails/original-tag.png" class="footer-img" alt="OG Source"> </a> </nav> </section> </footer>  </body> </html> 