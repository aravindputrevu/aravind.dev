---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const allGuides = await getCollection('guides');
const allPresentations = await getCollection('presentations');

// Combine both collections
const combined = [...allGuides, ...allPresentations];

// Sort by date descending (use 0 if missing)
const sortedItems = combined.sort((a, b) => {
  return (b.data.date?.getTime() || 0) - (a.data.date?.getTime() || 0);
});
---

<BaseLayout title="Archive - Guides & Presentations | Aravind Putrevu" description="Technical guides and conference presentations">
  <div class="container">
    <header>
      <h1>Archive</h1>
      <p class="subtitle">Technical guides and conference presentations.</p>
    </header>

    <div class="posts">
      {sortedItems.map((item) => (
        <a href={`/${item.slug}`} class="post">
          <h3>{item.data.title}</h3>
          {item.data.date && <time>{item.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>}
          {item.data.tags && (
            <div class="tags">
              {item.data.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </div>
          )}
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
